# Pexels Extension - Comprehensive Caching System Upgrade

## Technical Specification Document

**Version:** 1.0  
**Date:** 2025-11-28  
**Status:** Draft for Review

---

## Table of Contents

1. [Executive Summary](#1-executive-summary)
2. [Current Architecture Analysis](#2-current-architecture-analysis)
3. [Enhanced Caching System Design](#3-enhanced-caching-system-design)
4. [Favorites Management System](#4-favorites-management-system)
5. [Cache Browser UI](#5-cache-browser-ui)
6. [Data Models](#6-data-models)
7. [Implementation Plan](#7-implementation-plan)
8. [File Structure](#8-file-structure)
9. [API Reference](#9-api-reference)
10. [UI Mockups](#10-ui-mockups)

---

## 1. Executive Summary

### 1.1 Project Goals

This specification outlines a comprehensive upgrade to the Pexels Blender Extension's caching system, introducing:

1. **Persistent Content Storage** - Store previously viewed page contents to eliminate redundant searches
2. **Intelligent Memory Management** - Automatic cache optimization with configurable retention policies
3. **Favorites Management System** - Mark, organize, categorize, and quickly access preferred results
4. **Full-Featured Cache Browser** - Navigate, filter, sort, and view cached items without new searches
5. **Search History Timeline** - Visual timeline of search history with quick replay functionality
6. **Storage Usage Indicators** - Real-time monitoring of cache storage consumption

### 1.2 Key Benefits

- **Reduced API Calls** - Minimize redundant Pexels API requests
- **Offline Browsing** - Access previously viewed content without internet
- **Improved UX** - Faster access to frequently used images
- **Better Organization** - Categorize and manage favorite images
- **Resource Efficiency** - Intelligent memory management prevents bloat

---

## 2. Current Architecture Analysis

### 2.1 Existing Components

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Current Architecture                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚  â”‚   api.py     â”‚â”€â”€â”€â–¶â”‚ operators.py â”‚â”€â”€â”€â–¶â”‚    ui.py     â”‚       â”‚
â”‚  â”‚  (Pexels API)â”‚    â”‚  (Actions)   â”‚    â”‚   (Panels)   â”‚       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â”‚         â”‚                   â”‚                   â”‚                â”‚
â”‚         â–¼                   â–¼                   â–¼                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚  â”‚network_mgr.pyâ”‚    â”‚task_manager  â”‚    â”‚properties.py â”‚       â”‚
â”‚  â”‚ (HTTP/Retry) â”‚    â”‚ (Background) â”‚    â”‚   (State)    â”‚       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â”‚         â”‚                   â”‚                                    â”‚
â”‚         â–¼                   â–¼                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚  â”‚              cache_manager.py                         â”‚       â”‚
â”‚  â”‚  - Two-tier cache (Memory LRU + Disk)                â”‚       â”‚
â”‚  â”‚  - 500MB disk limit, 100 memory items                â”‚       â”‚
â”‚  â”‚  - 7-day TTL default                                 â”‚       â”‚
â”‚  â”‚  - Basic statistics tracking                         â”‚       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.2 Current CacheManager Features

| Feature | Status | Notes |
|---------|--------|-------|
| Memory LRU Cache | âœ… | 100 items max |
| Disk Cache | âœ… | 500MB max |
| TTL Support | âœ… | 7-day default |
| Cache Statistics | âœ… | Basic hit/miss tracking |
| Thread Safety | âœ… | RLock implementation |
| Automatic Cleanup | âœ… | LRU eviction |
| Search Result Caching | âŒ | Not implemented |
| Favorites System | âŒ | Not implemented |
| Cache Browser | âŒ | Not implemented |
| Search History | âŒ | Not implemented |
| Configurable Retention | âŒ | Hardcoded values |

### 2.3 Current Data Flow

```
User Search â†’ API Request â†’ Download Thumbnails â†’ Cache Images â†’ Display Results
                                    â†“
                            (No search result caching)
                            (No history tracking)
                            (No favorites support)
```

---

## 3. Enhanced Caching System Design

### 3.1 Architecture Overview

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      Enhanced Caching Architecture                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                        ENHANCED CACHE MANAGER                          â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚ â”‚
â”‚  â”‚  â”‚  Image Cache    â”‚  â”‚  Search Cache   â”‚  â”‚  Metadata Cache â”‚        â”‚ â”‚
â”‚  â”‚  â”‚  - Thumbnails   â”‚  â”‚  - Query+Resultsâ”‚  â”‚  - Timestamps   â”‚        â”‚ â”‚
â”‚  â”‚  â”‚  - Full Images  â”‚  â”‚  - Pagination   â”‚  â”‚  - Access Count â”‚        â”‚ â”‚
â”‚  â”‚  â”‚  - Previews     â”‚  â”‚  - Total Count  â”‚  â”‚  - Categories   â”‚        â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚ â”‚
â”‚  â”‚                                                                        â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚ â”‚
â”‚  â”‚  â”‚ Favorites Store â”‚  â”‚  History Store  â”‚  â”‚  Config Store   â”‚        â”‚ â”‚
â”‚  â”‚  â”‚  - Marked Items â”‚  â”‚  - Search Log   â”‚  â”‚  - Retention    â”‚        â”‚ â”‚
â”‚  â”‚  â”‚  - Categories   â”‚  â”‚  - Timeline     â”‚  â”‚  - Limits       â”‚        â”‚ â”‚
â”‚  â”‚  â”‚  - Tags         â”‚  â”‚  - Statistics   â”‚  â”‚  - Policies     â”‚        â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                    â”‚                                         â”‚
â”‚                                    â–¼                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                         STORAGE LAYER                                  â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚ â”‚
â”‚  â”‚  â”‚  Memory Cache   â”‚  â”‚   Disk Cache    â”‚  â”‚   SQLite DB     â”‚        â”‚ â”‚
â”‚  â”‚  â”‚  (Hot Data)     â”‚  â”‚  (Image Files)  â”‚  â”‚  (Metadata)     â”‚        â”‚ â”‚
â”‚  â”‚  â”‚  LRU Eviction   â”‚  â”‚  Size-Limited   â”‚  â”‚  Indexed        â”‚        â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3.2 New Components

#### 3.2.1 Search Result Cache

Stores complete search results to enable instant replay without API calls.

```python
@dataclass
class SearchResultCache:
    """Cached search result with full metadata."""
    query: str
    page: int
    per_page: int
    total_results: int
    photos: List[PhotoData]
    cached_at: float
    expires_at: float
    access_count: int = 0
    last_accessed: float = 0.0
```

#### 3.2.2 Enhanced Metadata Store

SQLite-based metadata storage for efficient querying and persistence.

```python
class MetadataStore:
    """SQLite-based metadata storage for cache entries."""
    
    Tables:
    - cache_entries: Image cache metadata
    - search_results: Cached search queries
    - favorites: User favorites with categories
    - search_history: Search history timeline
    - categories: User-defined categories
    - tags: Image tags for filtering
```

#### 3.2.3 Retention Policy Engine

Configurable retention policies for intelligent cache management.

```python
@dataclass
class RetentionPolicy:
    """Configurable cache retention policy."""
    max_disk_size_mb: int = 500
    max_memory_items: int = 100
    default_ttl_days: int = 7
    favorites_ttl_days: int = 365  # Favorites kept longer
    search_cache_ttl_hours: int = 24
    history_retention_days: int = 30
    cleanup_threshold_percent: float = 80.0
    cleanup_target_percent: float = 60.0
```

### 3.3 Data Flow - Enhanced

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        Enhanced Data Flow                                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                              â”‚
â”‚  User Search                                                                 â”‚
â”‚      â”‚                                                                       â”‚
â”‚      â–¼                                                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  Check Search Cache                                                  â”‚    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚    â”‚
â”‚  â”‚  â”‚ Cache Hit?  â”‚â”€Yesâ”€â–¶â”‚ Load Cached â”‚â”€â”€â”€â”€â”€â–¶â”‚ Display     â”‚           â”‚    â”‚
â”‚  â”‚  â”‚             â”‚      â”‚ Results     â”‚      â”‚ Results     â”‚           â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚    â”‚
â”‚  â”‚        â”‚ No                                       â”‚                  â”‚    â”‚
â”‚  â”‚        â–¼                                          â–¼                  â”‚    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚    â”‚
â”‚  â”‚  â”‚ API Request â”‚â”€â”€â”€â”€â”€â–¶â”‚ Cache       â”‚â”€â”€â”€â”€â”€â–¶â”‚ Update      â”‚           â”‚    â”‚
â”‚  â”‚  â”‚             â”‚      â”‚ Results     â”‚      â”‚ History     â”‚           â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                              â”‚
â”‚  Thumbnail Loading                                                           â”‚
â”‚      â”‚                                                                       â”‚
â”‚      â–¼                                                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚    â”‚
â”‚  â”‚  â”‚ Memory      â”‚â”€Hitâ”€â–¶â”‚ Return      â”‚     â”‚             â”‚           â”‚    â”‚
â”‚  â”‚  â”‚ Cache       â”‚      â”‚ Immediately â”‚     â”‚             â”‚           â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚             â”‚           â”‚    â”‚
â”‚  â”‚        â”‚ Miss                             â”‚             â”‚           â”‚    â”‚
â”‚  â”‚        â–¼                                  â”‚             â”‚           â”‚    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚             â”‚           â”‚    â”‚
â”‚  â”‚  â”‚ Disk Cache  â”‚â”€Hitâ”€â–¶â”‚ Load to     â”‚â”€â”€â”€â”€â”€â–¶â”‚ Return      â”‚           â”‚    â”‚
â”‚  â”‚  â”‚             â”‚      â”‚ Memory      â”‚      â”‚             â”‚           â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚    â”‚
â”‚  â”‚        â”‚ Miss                                                        â”‚    â”‚
â”‚  â”‚        â–¼                                                             â”‚    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚    â”‚
â”‚  â”‚  â”‚ Download    â”‚â”€â”€â”€â”€â”€â–¶â”‚ Cache Both  â”‚â”€â”€â”€â”€â”€â–¶â”‚ Return      â”‚           â”‚    â”‚
â”‚  â”‚  â”‚             â”‚      â”‚ Tiers       â”‚      â”‚             â”‚           â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 4. Favorites Management System

### 4.1 Features Overview

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      Favorites Management System                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚                         CORE FEATURES                                â”‚    â”‚
â”‚  â”‚                                                                      â”‚    â”‚
â”‚  â”‚  â˜… Mark/Unmark Favorites     â˜… Category Organization               â”‚    â”‚
â”‚  â”‚  â˜… Custom Tags               â˜… Quick Access Panel                  â”‚    â”‚
â”‚  â”‚  â˜… Bulk Operations           â˜… Export/Import                       â”‚    â”‚
â”‚  â”‚  â˜… Search Within Favorites   â˜… Sort Options                        â”‚    â”‚
â”‚  â”‚  â˜… Thumbnail Previews        â˜… Metadata Display                    â”‚    â”‚
â”‚  â”‚                                                                      â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚                      CATEGORY SYSTEM                                 â”‚    â”‚
â”‚  â”‚                                                                      â”‚    â”‚
â”‚  â”‚  Default Categories:                                                 â”‚    â”‚
â”‚  â”‚  â”œâ”€â”€ ðŸ“ All Favorites                                               â”‚    â”‚
â”‚  â”‚  â”œâ”€â”€ ðŸ“ Uncategorized                                               â”‚    â”‚
â”‚  â”‚  â”œâ”€â”€ ðŸ“ Recently Added                                              â”‚    â”‚
â”‚  â”‚  â””â”€â”€ ðŸ“ Most Used                                                   â”‚    â”‚
â”‚  â”‚                                                                      â”‚    â”‚
â”‚  â”‚  User Categories:                                                    â”‚    â”‚
â”‚  â”‚  â”œâ”€â”€ ðŸ“ [Custom Category 1]                                         â”‚    â”‚
â”‚  â”‚  â”œâ”€â”€ ðŸ“ [Custom Category 2]                                         â”‚    â”‚
â”‚  â”‚  â””â”€â”€ ðŸ“ ...                                                         â”‚    â”‚
â”‚  â”‚                                                                      â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 4.2 Data Model

```python
@dataclass
class FavoriteItem:
    """Represents a favorited image."""
    id: str                          # Unique favorite ID
    pexels_id: int                   # Original Pexels image ID
    thumb_url: str                   # Thumbnail URL
    full_url: str                    # Full image URL
    photographer: str                # Photographer name
    width: int                       # Image width
    height: int                      # Image height
    category_id: Optional[str]       # Category assignment
    tags: List[str]                  # User-defined tags
    notes: str                       # User notes
    added_at: float                  # Timestamp when favorited
    last_used: float                 # Last time imported/used
    use_count: int                   # Number of times used
    cached_thumb_path: Optional[str] # Local thumbnail path
    cached_full_path: Optional[str]  # Local full image path

@dataclass
class Category:
    """User-defined category for organizing favorites."""
    id: str                          # Unique category ID
    name: str                        # Display name
    color: str                       # Color code for UI
    icon: str                        # Icon identifier
    created_at: float                # Creation timestamp
    item_count: int                  # Number of items
    sort_order: int                  # Display order
```

### 4.3 Favorites Operations

| Operation | Description | Keyboard Shortcut |
|-----------|-------------|-------------------|
| Toggle Favorite | Mark/unmark selected image | `F` |
| Quick Add | Add to default category | `Shift+F` |
| Add to Category | Add with category selection | `Ctrl+F` |
| Remove Favorite | Remove from favorites | `Delete` |
| Edit Tags | Edit tags for selected | `T` |
| Move to Category | Move to different category | `M` |
| Bulk Select | Select multiple items | `Shift+Click` |
| Select All | Select all visible | `Ctrl+A` |

---

## 5. Cache Browser UI

### 5.1 UI Layout

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           CACHE BROWSER PANEL                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  ðŸ“Š Storage Overview                                                 â”‚    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚    â”‚
â”‚  â”‚  â”‚  Disk: â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘  245.3 MB / 500 MB (49%)        â”‚    â”‚    â”‚
â”‚  â”‚  â”‚  Memory: â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘  62 / 100 items (62%)           â”‚    â”‚    â”‚
â”‚  â”‚  â”‚  Favorites: 47 items | History: 156 searches                â”‚    â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  ðŸ” Filter & Sort                                                    â”‚    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚    â”‚
â”‚  â”‚  â”‚ [Search...]      â”‚ â”‚ Sort: Recentâ–¼â”‚ â”‚ View: [Grid][List]   â”‚    â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚    â”‚
â”‚  â”‚  â”‚ Type: [All] [Images] [Thumbnails] [Search Results]           â”‚  â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  ðŸ“ Categories / Tabs                                                â”‚    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚    â”‚
â”‚  â”‚  â”‚All (156)â”‚ â”‚â˜…Favs(47)â”‚ â”‚History â”‚ â”‚Cached  â”‚ â”‚Settingsâ”‚            â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  ðŸ–¼ï¸ Content Grid                                                     â”‚    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚    â”‚
â”‚  â”‚  â”‚ [thumb] â”‚ â”‚ [thumb] â”‚ â”‚ [thumb] â”‚ â”‚ [thumb] â”‚ â”‚ [thumb] â”‚       â”‚    â”‚
â”‚  â”‚  â”‚ â˜… ðŸ·ï¸    â”‚ â”‚ â˜…       â”‚ â”‚   ðŸ·ï¸    â”‚ â”‚         â”‚ â”‚ â˜… ðŸ·ï¸    â”‚       â”‚    â”‚
â”‚  â”‚  â”‚ 1920x1080â”‚ â”‚ 800x600 â”‚ â”‚ 1280x720â”‚ â”‚ 640x480 â”‚ â”‚ 1920x1200â”‚      â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚    â”‚
â”‚  â”‚  â”‚ [thumb] â”‚ â”‚ [thumb] â”‚ â”‚ [thumb] â”‚ â”‚ [thumb] â”‚ â”‚ [thumb] â”‚       â”‚    â”‚
â”‚  â”‚  â”‚         â”‚ â”‚ â˜…       â”‚ â”‚         â”‚ â”‚ â˜… ðŸ·ï¸    â”‚ â”‚         â”‚       â”‚    â”‚
â”‚  â”‚  â”‚ 800x600 â”‚ â”‚ 1024x768â”‚ â”‚ 1600x900â”‚ â”‚ 2560x1440â”‚ â”‚ 1280x960â”‚      â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  ðŸ“‹ Selected Item Details                                            â”‚    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚    â”‚
â”‚  â”‚  â”‚  ID: 12345678 | Size: 1920x1080 | Cached: 2.3 MB            â”‚    â”‚    â”‚
â”‚  â”‚  â”‚  Photographer: John Doe | Added: 2024-01-15                 â”‚    â”‚    â”‚
â”‚  â”‚  â”‚  Tags: nature, landscape, mountains                         â”‚    â”‚    â”‚
â”‚  â”‚  â”‚  [â˜… Favorite] [Import as Plane] [Import Image] [Delete]     â”‚    â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  ðŸ—‘ï¸ Bulk Actions                                                     â”‚    â”‚
â”‚  â”‚  [Select All] [Clear Selection] [Delete Selected] [Export Selected] â”‚    â”‚
â”‚  â”‚  [Clear All Cache] [Clear Expired] [Optimize Storage]               â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 5.2 Search History Timeline

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        SEARCH HISTORY TIMELINE                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                              â”‚
â”‚  Today                                                                       â”‚
â”‚  â”œâ”€â”€ 14:32  "mountain landscape"     [156 results] [â–¶ Replay] [ðŸ—‘ï¸]         â”‚
â”‚  â”œâ”€â”€ 13:15  "abstract patterns"      [89 results]  [â–¶ Replay] [ðŸ—‘ï¸]         â”‚
â”‚  â””â”€â”€ 10:45  "office workspace"       [234 results] [â–¶ Replay] [ðŸ—‘ï¸]         â”‚
â”‚                                                                              â”‚
â”‚  Yesterday                                                                   â”‚
â”‚  â”œâ”€â”€ 18:20  "nature sunset"          [312 results] [â–¶ Replay] [ðŸ—‘ï¸]         â”‚
â”‚  â”œâ”€â”€ 15:30  "city architecture"      [178 results] [â–¶ Replay] [ðŸ—‘ï¸]         â”‚
â”‚  â””â”€â”€ 09:00  "food photography"       [445 results] [â–¶ Replay] [ðŸ—‘ï¸]         â”‚
â”‚                                                                              â”‚
â”‚  This Week                                                                   â”‚
â”‚  â”œâ”€â”€ Mon    "technology devices"     [267 results] [â–¶ Replay] [ðŸ—‘ï¸]         â”‚
â”‚  â”œâ”€â”€ Sun    "people working"         [523 results] [â–¶ Replay] [ðŸ—‘ï¸]         â”‚
â”‚  â””â”€â”€ Sat    "animals wildlife"       [189 results] [â–¶ Replay] [ðŸ—‘ï¸]         â”‚
â”‚                                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  [Clear Today] [Clear This Week] [Clear All History]                â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 5.3 Settings Panel

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          CACHE SETTINGS                                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                              â”‚
â”‚  ðŸ“¦ Storage Limits                                                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  Maximum Disk Cache:     [500    ] MB                               â”‚    â”‚
â”‚  â”‚  Maximum Memory Items:   [100    ] items                            â”‚    â”‚
â”‚  â”‚  Cleanup Threshold:      [80     ] %                                â”‚    â”‚
â”‚  â”‚  Cleanup Target:         [60     ] %                                â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                              â”‚
â”‚  â±ï¸ Retention Policies                                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  Default Image TTL:      [7      ] days                             â”‚    â”‚
â”‚  â”‚  Favorites TTL:          [365    ] days                             â”‚    â”‚
â”‚  â”‚  Search Cache TTL:       [24     ] hours                            â”‚    â”‚
â”‚  â”‚  History Retention:      [30     ] days                             â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                              â”‚
â”‚  ðŸ”„ Auto-Cleanup                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  [âœ“] Enable automatic cleanup                                       â”‚    â”‚
â”‚  â”‚  [âœ“] Clean expired items on startup                                 â”‚    â”‚
â”‚  â”‚  [âœ“] Preserve favorites during cleanup                              â”‚    â”‚
â”‚  â”‚  [ ] Aggressive memory management                                   â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                              â”‚
â”‚  ðŸ“Š Statistics                                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  Cache Hit Rate:         87.3%                                      â”‚    â”‚
â”‚  â”‚  Total Requests:         1,234                                      â”‚    â”‚
â”‚  â”‚  Memory Hits:            856                                        â”‚    â”‚
â”‚  â”‚  Disk Hits:              221                                        â”‚    â”‚
â”‚  â”‚  API Calls Saved:        ~1,077                                     â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                              â”‚
â”‚  [Apply Changes] [Reset to Defaults] [Export Settings] [Import Settings]    â”‚
â”‚                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 6. Data Models

### 6.1 SQLite Database Schema

```sql
-- Cache entries table
CREATE TABLE cache_entries (
    id TEXT PRIMARY KEY,
    cache_key TEXT UNIQUE NOT NULL,
    file_path TEXT NOT NULL,
    size_bytes INTEGER NOT NULL,
    content_type TEXT,
    original_url TEXT,
    variant TEXT DEFAULT '',
    created_at REAL NOT NULL,
    last_accessed REAL NOT NULL,
    expires_at REAL,
    access_count INTEGER DEFAULT 0,
    metadata TEXT  -- JSON blob
);

CREATE INDEX idx_cache_key ON cache_entries(cache_key);
CREATE INDEX idx_expires_at ON cache_entries(expires_at);
CREATE INDEX idx_last_accessed ON cache_entries(last_accessed);

-- Search results cache
CREATE TABLE search_cache (
    id TEXT PRIMARY KEY,
    query TEXT NOT NULL,
    query_hash TEXT NOT NULL,
    page INTEGER NOT NULL,
    per_page INTEGER NOT NULL,
    total_results INTEGER NOT NULL,
    results_json TEXT NOT NULL,  -- JSON array of photo data
    cached_at REAL NOT NULL,
    expires_at REAL NOT NULL,
    access_count INTEGER DEFAULT 0,
    last_accessed REAL,
    UNIQUE(query_hash, page, per_page)
);

CREATE INDEX idx_query_hash ON search_cache(query_hash);
CREATE INDEX idx_search_expires ON search_cache(expires_at);

-- Favorites table
CREATE TABLE favorites (
    id TEXT PRIMARY KEY,
    pexels_id INTEGER NOT NULL UNIQUE,
    thumb_url TEXT NOT NULL,
    full_url TEXT NOT NULL,
    photographer TEXT,
    width INTEGER,
    height INTEGER,
    category_id TEXT,
    tags TEXT,  -- JSON array
    notes TEXT DEFAULT '',
    added_at REAL NOT NULL,
    last_used REAL,
    use_count INTEGER DEFAULT 0,
    cached_thumb_path TEXT,
    cached_full_path TEXT,
    FOREIGN KEY (category_id) REFERENCES categories(id)
);

CREATE INDEX idx_favorites_pexels ON favorites(pexels_id);
CREATE INDEX idx_favorites_category ON favorites(category_id);
CREATE INDEX idx_favorites_added ON favorites(added_at);

-- Categories table
CREATE TABLE categories (
    id TEXT PRIMARY KEY,
    name TEXT NOT NULL UNIQUE,
    color TEXT DEFAULT '#808080',
    icon TEXT DEFAULT 'COLLECTION_NEW',
    created_at REAL NOT NULL,
    sort_order INTEGER DEFAULT 0
);

-- Search history table
CREATE TABLE search_history (
    id TEXT PRIMARY KEY,
    query TEXT NOT NULL,
    query_hash TEXT NOT NULL,
    result_count INTEGER NOT NULL,
    searched_at REAL NOT NULL,
    page INTEGER DEFAULT 1,
    per_page INTEGER DEFAULT 50,
    cached_result_id TEXT,
    FOREIGN KEY (cached_result_id) REFERENCES search_cache(id)
);

CREATE INDEX idx_history_time ON search_history(searched_at);
CREATE INDEX idx_history_query ON search_history(query_hash);

-- Tags table for efficient tag queries
CREATE TABLE tags (
    id TEXT PRIMARY KEY,
    name TEXT NOT NULL UNIQUE,
    use_count INTEGER DEFAULT 0,
    created_at REAL NOT NULL
);

CREATE INDEX idx_tags_name ON tags(name);

-- Favorite-tag junction table
CREATE TABLE favorite_tags (
    favorite_id TEXT NOT NULL,
    tag_id TEXT NOT NULL,
    PRIMARY KEY (favorite_id, tag_id),
    FOREIGN KEY (favorite_id) REFERENCES favorites(id),
    FOREIGN KEY (tag_id) REFERENCES tags(id)
);

-- Settings table
CREATE TABLE settings (
    key TEXT PRIMARY KEY,
    value TEXT NOT NULL,
    updated_at REAL NOT NULL
);
```

### 6.2 Python Data Classes

```python
# enhanced_cache_manager.py

from dataclasses import dataclass, field
from typing import Optional, List, Dict, Any
from enum import Enum, auto

class CacheType(Enum):
    """Types of cached content."""
    THUMBNAIL = auto()
    FULL_IMAGE = auto()
    SEARCH_RESULT = auto()
    PREVIEW = auto()

@dataclass
class EnhancedCacheEntry:
    """Enhanced cache entry with full metadata."""
    id: str
    cache_key: str
    file_path: str
    size_bytes: int
    content_type: str
    original_url: str
    variant: str
    created_at: float
    last_accessed: float
    expires_at: Optional[float]
    access_count: int
    cache_type: CacheType
    metadata: Dict[str, Any] = field(default_factory=dict)
    
    # Computed properties
    @property
    def is_expired(self) -> bool:
        if self.expires_at is None:
            return False
        return time.time() > self.expires_at
    
    @property
    def age_days(self) -> float:
        return (time.time() - self.created_at) / 86400

@dataclass
class CachedSearchResult:
    """Cached search result with photos."""
    id: str
    query: str
    query_hash: str
    page: int
    per_page: int
    total_results: int
    photos: List[Dict[str, Any]]
    cached_at: float
    expires_at: float
    access_count: int
    last_accessed: Optional[float]

@dataclass
class FavoriteItem:
    """User favorite with full metadata."""
    id: str
    pexels_id: int
    thumb_url: str
    full_url: str
    photographer: str
    width: int
    height: int
    category_id: Optional[str]
    tags: List[str]
    notes: str
    added_at: float
    last_used: Optional[float]
    use_count: int
    cached_thumb_path: Optional[str]
    cached_full_path: Optional[str]

@dataclass
class Category:
    """Favorite category."""
    id: str
    name: str
    color: str
    icon: str
    created_at: float
    sort_order: int
    item_count: int = 0

@dataclass
class SearchHistoryEntry:
    """Search history entry."""
    id: str
    query: str
    query_hash: str
    result_count: int
    searched_at: float
    page: int
    per_page: int
    cached_result_id: Optional[str]

@dataclass
class CacheStatistics:
    """Comprehensive cache statistics."""
    # Storage
    disk_used_bytes: int
    disk_max_bytes: int
    memory_items: int
    memory_max_items: int
    
    # Counts
    total_cached_images: int
    total_cached_searches: int
    total_favorites: int
    total_history_entries: int
    
    # Performance
    cache_hits: int
    cache_misses: int
    memory_hits: int
    disk_hits: int
    hit_rate_percent: float
    
    # Computed
    @property
    def disk_used_percent(self) -> float:
        if self.disk_max_bytes == 0:
            return 0.0
        return (self.disk_used_bytes / self.disk_max_bytes) * 100
    
    @property
    def memory_used_percent(self) -> float:
        if self.memory_max_items == 0:
            return 0.0
        return (self.memory_items / self.memory_max_items) * 100
    
    @property
    def api_calls_saved(self) -> int:
        return self.cache_hits

@dataclass
class RetentionPolicy:
    """Configurable retention policy."""
    max_disk_size_mb: int = 500
    max_memory_items: int = 100
    default_ttl_days: int = 7
    favorites_ttl_days: int = 365
    search_cache_ttl_hours: int = 24
    history_retention_days: int = 30
    cleanup_threshold_percent: float = 80.0
    cleanup_target_percent: float = 60.0
    preserve_favorites: bool = True
    auto_cleanup_enabled: bool = True
    cleanup_on_startup: bool = True
```

---

## 7. Implementation Plan

### 7.1 Phase 1: Enhanced Cache Manager (Core)

**Duration:** 2-3 days

**Tasks:**
1. Create SQLite database manager (`database_manager.py`)
2. Implement enhanced cache entry model
3. Add search result caching
4. Implement metadata storage
5. Add configurable retention policies
6. Update existing `cache_manager.py` to use new system

**Files to Create/Modify:**
- `database_manager.py` (new)
- `cache_manager.py` (enhance)
- `models.py` (new - data classes)

### 7.2 Phase 2: Favorites System

**Duration:** 2-3 days

**Tasks:**
1. Implement favorites storage
2. Create category management
3. Add tagging system
4. Implement favorites operations
5. Create favorites operators

**Files to Create/Modify:**
- `favorites_manager.py` (new)
- `operators.py` (add favorites operators)
- `properties.py` (add favorites properties)

### 7.3 Phase 3: Search History

**Duration:** 1-2 days

**Tasks:**
1. Implement search history tracking
2. Add history replay functionality
3. Create history cleanup
4. Add history statistics

**Files to Create/Modify:**
- `history_manager.py` (new)
- `operators.py` (add history operators)

### 7.4 Phase 4: Cache Browser UI

**Duration:** 3-4 days

**Tasks:**
1. Create cache browser panel
2. Implement storage overview
3. Add filter and sort controls
4. Create content grid view
5. Implement item details panel
6. Add bulk actions
7. Create settings panel

**Files to Create/Modify:**
- `ui_cache_browser.py` (new)
- `ui.py` (integrate new panels)
- `operators.py` (add UI operators)

### 7.5 Phase 5: Integration & Testing

**Duration:** 2-3 days

**Tasks:**
1. Integrate all components
2. Update existing operators
3. Add migration for existing cache
4. Performance optimization
5. Testing and bug fixes

**Files to Modify:**
- `__init__.py`
- All existing files for integration

### 7.6 Timeline Summary

```
Week 1:
â”œâ”€â”€ Day 1-2: Phase 1 - Enhanced Cache Manager
â”œâ”€â”€ Day 3-4: Phase 1 continued + Phase 2 start
â””â”€â”€ Day 5: Phase 2 - Favorites System

Week 2:
â”œâ”€â”€ Day 1-2: Phase 2 continued + Phase 3
â”œâ”€â”€ Day 3-5: Phase 4 - Cache Browser UI
â””â”€â”€ Day 6-7: Phase 5 - Integration & Testing
```

---

## 8. File Structure

### 8.1 New File Organization

```
pexels_ext/
â”œâ”€â”€ __init__.py              # Main addon registration
â”œâ”€â”€ api.py                   # Pexels API handling
â”œâ”€â”€ blender_manifest.toml    # Addon manifest
â”‚
â”œâ”€â”€ # Core Managers
â”œâ”€â”€ cache_manager.py         # Enhanced cache manager
â”œâ”€â”€ database_manager.py      # NEW: SQLite database manager
â”œâ”€â”€ favorites_manager.py     # NEW: Favorites management
â”œâ”€â”€ history_manager.py       # NEW: Search history management
â”œâ”€â”€ network_manager.py       # Network utilities
â”œâ”€â”€ task_manager.py          # Background task management
â”œâ”€â”€ progress_tracker.py      # Progress tracking
â”œâ”€â”€ logger.py                # Logging system
â”‚
â”œâ”€â”€ # Data Models
â”œâ”€â”€ models.py                # NEW: Data classes and enums
â”‚
â”œâ”€â”€ # Blender Integration
â”œâ”€â”€ operators.py             # Blender operators (enhanced)
â”œâ”€â”€ properties.py            # Blender properties (enhanced)
â”‚
â”œâ”€â”€ # User Interface
â”œâ”€â”€ ui.py                    # Main UI panels
â”œâ”€â”€ ui_cache_browser.py      # NEW: Cache browser UI
â”œâ”€â”€ ui_favorites.py          # NEW: Favorites UI components
â”œâ”€â”€ ui_history.py            # NEW: History timeline UI
â”‚
â”œâ”€â”€ # Utilities
â”œâ”€â”€ utils.py                 # Utility functions
â”‚
â””â”€â”€ README.md                # Documentation
```

### 8.2 Module Dependencies

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         Module Dependency Graph                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                              â”‚
â”‚                              __init__.py                                     â”‚
â”‚                                   â”‚                                          â”‚
â”‚                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                          â”‚
â”‚                    â–¼              â–¼              â–¼                          â”‚
â”‚               operators.py   properties.py    ui.py                         â”‚
â”‚                    â”‚              â”‚              â”‚                          â”‚
â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”‚
â”‚         â–¼                        â–¼                        â–¼                â”‚
â”‚    api.py              cache_manager.py           ui_cache_browser.py      â”‚
â”‚         â”‚                        â”‚                        â”‚                â”‚
â”‚         â–¼                        â–¼                        â–¼                â”‚
â”‚  network_manager.py      database_manager.py      ui_favorites.py          â”‚
â”‚         â”‚                        â”‚                        â”‚                â”‚
â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â”‚
â”‚                                  â–¼                                          â”‚
â”‚                             models.py                                       â”‚
â”‚                                  â”‚                                          â”‚
â”‚                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                           â”‚
â”‚                    â–¼             â–¼             â–¼                           â”‚
â”‚           favorites_manager  history_manager  logger.py                    â”‚
â”‚                    â”‚             â”‚                                          â”‚
â”‚                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
â”‚                                  â–¼                                          â”‚
â”‚                          progress_tracker.py                                â”‚
â”‚                                  â”‚                                          â”‚
â”‚                                  â–¼                                          â”‚
â”‚                          task_manager.py                                    â”‚
â”‚                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 9. API Reference

### 9.1 Enhanced CacheManager API

```python
class EnhancedCacheManager:
    """Enhanced cache manager with search caching and favorites support."""
    
    # Image Caching
    def get_image(self, url: str, variant: str = "") -> Optional[bytes]
    def put_image(self, url: str, data: bytes, variant: str = "", 
                  metadata: Dict = None) -> str
    def has_image(self, url: str, variant: str = "") -> bool
    def get_image_path(self, url: str, variant: str = "") -> Optional[str]
    def invalidate_image(self, url: str, variant: str = "") -> bool
    
    # Search Result Caching
    def get_search_results(self, query: str, page: int, 
                           per_page: int) -> Optional[CachedSearchResult]
    def put_search_results(self, query: str, page: int, per_page: int,
                           total_results: int, photos: List[Dict]) -> str
    def has_search_results(self, query: str, page: int, per_page: int) -> bool
    def invalidate_search(self, query: str = None) -> int
    
    # Statistics
    def get_statistics(self) -> CacheStatistics
    def get_storage_info(self) -> Dict[str, Any]
    
    # Cleanup
    def cleanup_expired(self) -> int
    def cleanup_to_target(self, target_percent: float = 60.0) -> int
    def clear_all(self, preserve_favorites: bool = True) -> Tuple[int, int]
    
    # Configuration
    def get_retention_policy(self) -> RetentionPolicy
    def set_retention_policy(self, policy: RetentionPolicy) -> None
```

### 9.2 FavoritesManager API

```python
class FavoritesManager:
    """Manages user favorites with categories and tags."""
    
    # Favorites CRUD
    def add_favorite(self, pexels_id: int, thumb_url: str, full_url: str,
                     photographer: str, width: int, height: int,
                     category_id: str = None, tags: List[str] = None,
                     notes: str = "") -> FavoriteItem
    def remove_favorite(self, favorite_id: str) -> bool
    def remove_by_pexels_id(self, pexels_id: int) -> bool
    def get_favorite(self, favorite_id: str) -> Optional[FavoriteItem]
    def get_by_pexels_id(self, pexels_id: int) -> Optional[FavoriteItem]
    def is_favorite(self, pexels_id: int) -> bool
    def update_favorite(self, favorite_id: str, **kwargs) -> bool
    
    # Listing and Filtering
    def get_all_favorites(self, limit: int = None, 
                          offset: int = 0) -> List[FavoriteItem]
    def get_by_category(self, category_id: str) -> List[FavoriteItem]
    def get_by_tag(self, tag: str) -> List[FavoriteItem]
    def search_favorites(self, query: str) -> List[FavoriteItem]
    def get_recent_favorites(self, limit: int = 10) -> List[FavoriteItem]
    def get_most_used(self, limit: int = 10) -> List[FavoriteItem]
    
    # Categories
    def create_category(self, name: str, color: str = "#808080",
                        icon: str = "COLLECTION_NEW") -> Category
    def delete_category(self, category_id: str) -> bool
    def rename_category(self, category_id: str, new_name: str) -> bool
    def get_categories(self) -> List[Category]
    def move_to_category(self, favorite_id: str, category_id: str) -> bool
    
    # Tags
    def add_tag(self, favorite_id: str, tag: str) -> bool
    def remove_tag(self, favorite_id: str, tag: str) -> bool
    def get_all_tags(self) -> List[str]
    def get_tags_for_favorite(self, favorite_id: str) -> List[str]
    
    # Bulk Operations
    def bulk_add_to_category(self, favorite_ids: List[str], 
                             category_id: str) -> int
    def bulk_delete(self, favorite_ids: List[str]) -> int
    def bulk_add_tag(self, favorite_ids: List[str], tag: str) -> int
    
    # Statistics
    def get_favorites_count(self) -> int
    def get_category_counts(self) -> Dict[str, int]
    
    # Export/Import
    def export_favorites(self, filepath: str) -> bool
    def import_favorites(self, filepath: str) -> int
```

### 9.3 HistoryManager API

```python
class HistoryManager:
    """Manages search history with timeline and replay."""
    
    # History Recording
    def record_search(self, query: str, result_count: int, page: int = 1,
                      per_page: int = 50, cached_result_id: str = None) -> str
    
    # History Retrieval
    def get_history(self, limit: int = 100, 
                    offset: int = 0) -> List[SearchHistoryEntry]
    def get_today(self) -> List[SearchHistoryEntry]
    def get_this_week(self) -> List[SearchHistoryEntry]
    def get_by_date_range(self, start: float, end: float) -> List[SearchHistoryEntry]
    def search_history(self, query: str) -> List[SearchHistoryEntry]
    
    # History Management
    def delete_entry(self, entry_id: str) -> bool
    def clear_today(self) -> int
    def clear_this_week(self) -> int
    def clear_all(self) -> int
    def cleanup_old(self, days: int = 30) -> int
    
    # Statistics
    def get_history_count(self) -> int
    def get_popular_queries(self, limit: int = 10) -> List[Tuple[str, int]]
    def get_search_frequency(self) -> Dict[str, int]
```

---

## 10. UI Mockups

### 10.1 Main Panel Integration

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  PEXELS IMAGE SEARCH                                                    [â‰¡] â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                              â”‚
â”‚  ðŸ” Search Images                                                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ [mountain landscape                                    ] [Search]   â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                              â”‚
â”‚  ðŸ“Š Results: 156 / 1,234  |  Page 1  [â† Prev] [Next â†’]                      â”‚
â”‚  âœ… 1,077 requests remaining                                                 â”‚
â”‚                                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  [Preview Overlay]  [ðŸ“ Cache Browser]  [â˜… Favorites]               â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                              â”‚
â”‚  ðŸ“· Image Gallery                                                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”  â”‚    â”‚
â”‚  â”‚  â”‚[img]â”‚ â”‚[img]â”‚ â”‚[img]â”‚ â”‚[img]â”‚ â”‚[img]â”‚ â”‚[img]â”‚ â”‚[img]â”‚ â”‚[img]â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â˜…  â”‚ â”‚     â”‚ â”‚  â˜…  â”‚ â”‚     â”‚ â”‚     â”‚ â”‚  â˜…  â”‚ â”‚     â”‚ â”‚     â”‚  â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”˜  â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                              â”‚
â”‚  ðŸ“‹ Image Details                                                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  ID: 12345678  |  Size: 1920 Ã— 1080 pixels                          â”‚    â”‚
â”‚  â”‚  ðŸ“¸ Photo by: John Doe                                              â”‚    â”‚
â”‚  â”‚  [â˜… Add to Favorites]                                               â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                              â”‚
â”‚  â¬‡ Import Options                                                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  [Import as Plane]  [Import Image Only]                             â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â–¶ Settings                                                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â–¶ Caching Progress                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 10.2 Favorites Quick Panel

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  â˜… FAVORITES                                                            [â‰¡] â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                              â”‚
â”‚  Categories:                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ [All (47)] [Landscapes (12)] [Abstract (8)] [People (15)] [+ New]   â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”                   â”‚    â”‚
â”‚  â”‚  â”‚[img]â”‚ â”‚[img]â”‚ â”‚[img]â”‚ â”‚[img]â”‚ â”‚[img]â”‚ â”‚[img]â”‚                   â”‚    â”‚
â”‚  â”‚  â”‚ ðŸ·ï¸  â”‚ â”‚     â”‚ â”‚ ðŸ·ï¸  â”‚ â”‚ ðŸ·ï¸  â”‚ â”‚     â”‚ â”‚ ðŸ·ï¸  â”‚                   â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”˜                   â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                              â”‚
â”‚  Selected: Mountain Sunset                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  Tags: nature, sunset, mountains                                    â”‚    â”‚
â”‚  â”‚  Added: 2024-01-15  |  Used: 5 times                                â”‚    â”‚
â”‚  â”‚  [Import] [Edit Tags] [Move] [Remove â˜…]                             â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Summary

This specification outlines a comprehensive upgrade to the Pexels Blender Extension's caching system, introducing:

1. **Enhanced Cache Manager** with SQLite-backed metadata storage
2. **Search Result Caching** to eliminate redundant API calls
3. **Favorites Management** with categories, tags, and organization
4. **Search History Timeline** with replay functionality
5. **Full-Featured Cache Browser** UI for managing cached content
6. **Configurable Retention Policies** for intelligent memory management
7. **Storage Usage Indicators** for monitoring cache consumption

The implementation is planned in 5 phases over approximately 2 weeks, with careful attention to maintaining compatibility with the existing addon architecture while adding significant new functionality.

---

**Next Steps:**
1. Review this specification
2. Provide feedback on features and priorities
3. Approve for implementation
4. Switch to Code mode to begin development